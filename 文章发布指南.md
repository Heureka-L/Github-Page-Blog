# 文章发布指南

> **基于Heureka's Blog v3.0 - 书籍式技术博客系统**

本指南详细说明了基于Jekyll的书籍式技术博客系统的文章发布流程、页面架构和最佳实践。

## 🏗️ 系统架构概览

### 核心技术栈
- **静态生成**: Jekyll 4.x + GitHub Pages
- **样式框架**: Bootstrap 3.4.1 + 自定义书籍主题
- **构建工具**: Grunt + Node.js
- **数学公式**: MathJax 3.x
- **搜索**: Simple Jekyll Search

### 目录结构解析
```
Heureka-L.github.io/
├── _posts/               # 文章存储
│   ├── 2025-08-21-浮点数表示.md    # 标准文章
│   ├── data_rep/        # 分类存储
│   └── hidden/          # 隐藏文章
├── _data/books.yml      # 书籍章节映射
├── _layouts/            # 页面模板
│   ├── book.html        # 书籍阅读界面
│   └── default.html     # 基础模板
├── _includes/           # 可复用组件
├── books.html           # 书籍目录页
└── css/book-style.css   # 书籍专用样式
```

## ✍️ 文章发布完整流程

### 1. 创建文章文件

**命名规范**:
```
YYYY-MM-DD-文章标题.md
```

**存储位置选择**:
- **根目录文章**: 普通技术博客
- **data_rep/**: 数据表示系列文章
- **hidden/**: 草稿或不公开文章

### 2. 前置元数据配置

**书籍章节专用模板**:
```yaml
---
layout: book                    # 使用书籍布局
book: "STM32开发指南"          # 所属书籍名称
chapter: "第2章：定时器应用"    # 章节名称
section: "2.1 STM32定时器标准库配置流程"  # 小节名称
title: "STM32定时器标准库配置流程"       # 文章标题
subtitle: "从寄存器到应用的完整配置指南"   # 副标题
date: 2025-08-18 14:30:00
categories: [STM32, 嵌入式开发]
tags: [定时器, 标准库, 寄存器配置]
---
```

### 3. 内容编写规范

**书籍式结构要求**:
```markdown
# 章节标题

## 2.1 STM32定时器标准库配置流程

### 2.1.1 定时器基础知识

内容...

### 2.1.2 寄存器配置步骤

1. 步骤一
2. 步骤二

### 2.1.3 代码实现

```c
// 代码示例
```

### 2.1.4 实际应用

总结...
```

### 4. 书籍章节注册

**编辑 _data/books.yml**:
```yaml
books:
  - name: "STM32开发指南"
    chapters:
      - name: "第2章：定时器应用"
        sections:
          - name: "2.1 STM32定时器标准库配置流程"
            slug: "2025-08-18-STM32定时器标准库配置流程"
            url: "/2025/08/18/STM32定时器标准库配置流程/"
```

## 📖 页面架构详解

### 书籍阅读界面 (book.html)

**三栏式布局**:
- **左侧导航栏**: 280px固定宽度
  - 书籍标题显示
  - 章节树状导航
  - 当前章节高亮

- **中间内容区**: 自适应宽度
  - 文章标题和副标题
  - 书籍式排版
  - 数学公式支持

- **右侧目录栏**: 280px固定宽度
  - 文章内目录
  - 锚点导航

**顶部功能栏**:
```
┌─────────────────────────────────────────────────────────────┐
│  HOME    |    FOLLOW ME    |    CONTENT          [搜索图标]  │
└─────────────────────────────────────────────────────────────┘
```

**按钮功能**:
- **HOME**: 返回网站首页 `/`
- **FOLLOW ME**: GitHub个人主页
- **CONTENT**: 书籍目录页 `/books/`

### 书籍目录页面 (books.html)

**黑色主题设计**:
- **专属样式**: 仅在 `/books/` 页面生效
- **颜色方案**:
  - 导航背景: #1a1a1a
  - 文字颜色: #e0e0e0
  - 悬停高亮: #3498db

**网格布局**:
- **响应式设计**: 桌面端双列，手机端单列
- **书籍卡片**: 包含章节列表和阅读入口

## 🎨 样式系统

### 书籍专用样式 (book-style.css)

**核心样式变量**:
```css
:root {
  --book-primary: #3498db;
  --book-text: #2c3e50;
  --book-muted: #7f8c8d;
  --book-bg: #f8f9fa;
  --book-border: #e9ecef;
}
```

**响应式断点**:
- **桌面端**: >1200px (三栏布局)
- **平板端**: 768-1200px (双栏布局)
- **手机端**: <768px (单栏布局，隐藏右侧目录)

### 导航按钮样式

**统一设计**:
```css
.book-nav-btn {
  font-weight: 700;        /* 加粗文字 */
  border: 1px dashed #bdc3c7;
  border-radius: 20px;
  padding: 6px 12px;
  transition: all 0.3s ease;
}
```

## 🔧 高级配置

### 文章关联配置

**书籍关联**: 通过 `book`, `chapter`, `section` 字段
**系列文章**: 通过 `categories` 和 `tags`
**图片资源**: 存储在 `img/` 目录，使用绝对路径

### 数学公式支持

**MathJax配置**:
```yaml
# _config.yml中已启用
page-mathjax: true
```

**使用示例**:
```markdown
$$\sum_{i=1}^{n} x_i = \frac{n(n+1)}{2}$$
```

### 代码高亮

**支持的语法**:
- C/C++ (嵌入式开发)
- Python
- JavaScript
- Bash

**示例**:
```c
// STM32定时器配置
TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;
TIM_TimeBaseStructure.TIM_Period = 999;
TIM_TimeBaseStructure.TIM_Prescaler = 71;
TIM_TimeBaseInit(TIM2, &TIM_TimeBaseStructure);
```

## 🚀 发布流程

### 本地预览
```bash
# 安装依赖
bundle install

# 启动本地服务器
bundle exec jekyll serve

# 访问地址
http://localhost:4000
```

### GitHub Pages部署

**自动部署**:
- 推送到 `main` 分支自动部署
- 部署地址: `https://heureka-l.github.io`

**构建状态检查**:
- GitHub Actions工作流: `.github/workflows/jekyll.yml`
- 构建日志查看: Actions标签页

## 🤖 自动化工具

### PyQt博客管理器

**位置**: `BlogManage/blog_manager.py`

**功能特性**:
- 📚 **智能书籍管理**: 自动读取和更新 `_data/books.yml`
- 📝 **一键文章创建**: 填写表单自动生成文章和更新书籍数据
- 🎯 **可视化操作**: PyQt图形界面，支持中文输入
- 📊 **实时统计**: 显示各书籍章节文章数量

**使用方法**:
```bash
cd BlogManage
pip install -r requirements.txt
python blog_manager.py
# 或双击 run.bat
```

**界面功能**:
- **文章概览**: 显示所有书籍和文章统计
- **添加文章**: 填写表单自动创建文章
- **书籍创建**: 新书籍名称自动添加到书籍列表
- **章节管理**: 新章节自动创建并关联

## 📋 发布检查清单

### 文章发布前
- [ ] 使用博客管理器填写文章信息
- [ ] 确认书籍和章节信息正确
- [ ] 预览文章内容格式
- [ ] 检查标签分类
- [ ] 文件名自动生成 (YYYY-MM-DD-标题.md)

### 发布后验证
- [ ] 文章在 `/books/` 页面显示
- [ ] 左侧导航章节树正确
- [ ] 右侧目录生成正常
- [ ] 响应式布局测试
- [ ] 导航按钮功能正常

## 🐛 常见问题

### Q1: 文章不显示在书籍目录中？
**排查步骤**:
1. 检查 `_data/books.yml` 中的 `slug` 是否与文章文件名匹配
2. 确认文章使用了 `layout: book`
3. 验证 `book` 字段与书籍名称完全一致

### Q2: 数学公式不渲染？
**解决方案**:
- 确认文章包含 `page-mathjax: true`
- 检查公式语法是否正确
- 清除浏览器缓存后重试

### Q3: 本地预览正常，GitHub Pages不显示？
**常见原因**:
- 文件名包含中文或特殊字符
- 前置元数据格式错误
- 缺少必要的插件

### Q4: 如何添加新的书籍？
**步骤**:
1. 在 `_data/books.yml` 中添加新书籍配置
2. 创建对应的文章文件
3. 更新 `books.html` 的网格布局（如需要）

## 📊 性能优化

### 图片优化
- **格式**: 优先使用WebP，JPEG备选
- **尺寸**: 文章头图建议1200x630px
- **压缩**: 使用TinyPNG等工具压缩

### 构建优化
- **增量构建**: 使用 `--incremental` 参数
- **缓存利用**: 合理配置 `.gitignore`

---

**文档版本**: v3.1  
**最后更新**: 2025年1月  
**维护者**: Heureka's Blog Team

> 💡 **提示**: 本指南持续更新，建议收藏以便查阅最新信息。